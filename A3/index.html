<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Demo Assignment</title>
    <link rel="stylesheet" href="https://arcms.w4v.es/Assets/Supreme/stylesheet.css">
    <script type = "module" src = "../Solver/solver-frame.js"></script>
  </head>
  <body>
    <solver-frame>

      <!-- Problem Statement -->
      <section>
        <h1>Problem Statement</h1>
        <section>
          <img src = "./fig0.png" />
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </section>

        <!-- Execuative Summary -->
        <section>
          <h1>Execuative Summary</h1>
          <div>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
          </div>
        </section>

        <!-- Design Parameters -->
        <section>
          <h1>Design parameters</h1>
          <row-2>
            <div>
              <b>Design Dimensions</b>
              <row-1>
                <div>Pitch Circle Radius $r_p$ = </div>
                <div><input value = "308.64 / 2" class = "variable" name = "rp"/> $\tx{mm}$</div>
              </row-1>

              <row-1>
                <div>Plumber Gearbox Clearence $\tx{Clr}$ = </div>
                <div><input value = "20" class = "variable" name = "Clr"/> $\tx{mm}$</div>
              </row-1>

              <b>Plumber Block Dimensions</b>
              <row-1>
                <div>Plumber Bearing Spacing $\tx{Pbs}$ = </div>
                <div><input value = "330" class = "variable" name = "Pbs"/> $\tx{mm}$</div>
              </row-1>

              <row-1>
                <div>Plumber Bearing Width $\tx{Pbw}$ = </div>
                <div><input value = "110" class = "variable" name = "Pbw"/> $\tx{mm}$</div>
              </row-1>

              <b>Gearbox Dimensions</b>
              <row-1>
                <div>Gearbox Width $\tx{Gbw}$ = </div>
                <div><input value = "189" class = "variable" name = "Gbw"/> $\tx{mm}$</div>
              </row-1>

              <row-1>
                <div>Torque Arm Distance $\tx{Tad}$ = </div>
                <div><input value = "245" class = "variable" name = "Tad"/> $\tx{mm}$</div>
              </row-1>

              <row-1>
                <div>Gearbox + motor CoA Distance $\tx{Gcd}$ = </div>
                <div><input value = "245 * 0.6" class = "variable" name = "Gcd"/> $\tx{mm}$</div>
              </row-1>

              <row-1>
                <div>Weight of Gearbox + motor $m_w$ = </div>
                <div><input value = "90 + 40" class = "variable" name = "mw"/> $\tx{kg}$</div>
              </row-1>

              <row-1>
                <div>Gearbox shaft sleave diameter $D_G =$ </div>
                <div><input value = "85" class = "variable" name = "DG"/> $\tx{kg}$</div>
              </row-1>

              <row-1>
                <div>Output speed $n_e$ = </div>
                <div><input value = "100" class = "variable" name = "ne"/> $\tx{RPM}$</div>
              </row-1>
              <row-1>
                <div>Input speed $n_i$ = </div>
                <div><input value = "1440" class = "variable" name = "ni"/> $\tx{RPM}$</div>
              </row-1>
            </div>
            <div>
              <b>Factor of Safety</b>
              <row-1>
                <div>$F_S$ = </div>
                <div><input value = "2"  class = "variable" name = "FS"/> </div>
              </row-1>

              <b>Applied Forces</b>

              <row-1>
                <div>Maximum Load Force $F_L$ = </div>
                <div><input value = "15" class = "variable" name = "FL"/> $\tx{kN}$</div>
              </row-1>
              <row-1>
                <div>Angle of Tension Leg $\phi$ = </div>
                <div><input value = "15" class = "variable" name = "phi_deg"/>$^\circ$</div>
              </row-1>
              <script type = "solver">return {phi: phi_deg * pi / 180}</script>

              <b>Shaft material properties</b>
              <row-1>
                <div>Ultimate Tensile Strength $F_U$ = </div>
                <div><input value = "410" class = "variable" name = "FU"/> MPa</div>
              </row-1>
              <row-1>
                <div>Yield Strength $F_Y$ = </div>
                <div><input value = "230"  class = "variable" name = "FY"/> MPa</div>
              </row-1>
              <row-1>
                <div>Endurance Strength $F_R$ = </div>
                <div><input value = "FU * 0.45"  class = "variable" name = "FR"/> MPa</div>
              </row-1>
              <row-1>
                <div>Young's Modulus $E$ = </div>
                <div><input value = "90"  class = "variable" name = "E"/> $\tx{kN}/\tx{mm}^2$</div>
              </row-1>
              <b>Trial Diameter</b>
              <row-1>
                <div>$D_0$ = </div>
                <div><input value = 65  class = "variable" name = "D0"/> mm</div>
              </row-1>
            </div>
          </row-2>
        </section>
      </section>

      <!-- Shaft Design Process (15) -->
      <section>
        <h1>Shaft Design Process</h1>

        <!-- Maximum Force and Moments (5) -->
        <section collapsed>
          <h1>Maximum Forces and Bending Moment</h1>
          <row-2>
            <output>
              The torqueue generated from the tension leg was calculated as.
              $$T_q = r_p F_L = ~[Tq]{rp * FL} \tx{ kN} \cdot \tx{mm}$$
              As the the gearbox body does not spin, the sum of moments about the $x$ axis
              must equal the torque caused by the tension leg $\therefore$
              $T_q = \tx{Tad} T_1  + \tx{Gcd} m_w g$.
              $$T_1 = \cfrac{Tq - \tx{Gcd} m_w g}{\tx{Tad}} = ~2[T1]{(Tq - Gcd * mw * 9.81 * 1e-3)/(Tad)} \tx{ kN}$$
              $$F_W = T_1 + m_w g = ~2[FW]{T1 + mw * 9.81 * 1e-3} \tx{ kN}$$
              Looking at Figure 2 and taking the sum of all moments at the second plumber block (point $B$)
              $$\sum M_z = -\tx{Pbs}R_A + \cfrac{\tx{Pbs}}{2}\cos \phi F_L - d_1F_w = 0$$
              where $d_1 = \cfrac{2\tx{Clr} + \tx{Pbw} + \tx{Gbw}}{2} =~[d1]{(Pbw + Gbw)/2 + Clr} \tx{ mm}$.
            </output>
            <figure>
              <img src = "./fig_gbfbd.svg"/>
              <figcaption>
                FBD of Gearbox (from side)
              </figcaption>
            </figure>
          </row-2>
          <figure>
            <img src = "./fig_FBD.svg" />
            <figcaption>
              FBD of Shaft (from front and side)
            </figcaption>
          </figure>

          <output>
            From which the vertical component of $R_A$ was found
            $${R_A}_y  = \cfrac{1}{2}\cos \phi F_L - \cfrac{d_1}{\tx{Pbs}}F_W = ~2[RA]{0.5 * cos(phi) * FL - FW * (d1)/(Pbs)}\tx{ kN}$$
            By taking the sum of forces in the $y$ direction
            $${R_B}_y = F_L\cos \phi + F_W - {R_A}_y = ~2[RB]{FL * cos(phi) + FW - RA}\tx{ kN}$$
          </output>

          <figure>
            <div>
              <div>
                <svg-plot
                class = "variable"
                name = "Vplot"
                title = "Shear Force Plot"
                x-label = "$x \tx{ (mm)}$"
                y-label = "$v \tx{ (kN)}$"
                plot-size = "300, 90"
                grid-on>
                </svg-plot>
                <script type = "solver">
                  let d2 = (2 * Clr + Pbw + Gbw) / 2;
                  let FLy = FL * Math.cos(15 * Math.PI / 180);

                  let py = 5;
                  let miny = (RA - FLy);
                  Vplot.axisStart = `-20, ${miny - py*1.25}`
                  Vplot.axisEnd = `${d2 + Pbs + 20}, ${(RA - FLy + RB) + py}`;

                  Vplot.line("shear", [[0,0],[0, RA], [Pbs/2, RA], [Pbs/2, RA - FLy], [Pbs, RA - FLy], [Pbs, RA - FLy + RB], [Pbs + d2, RA - FLy + RB], [Pbs + d2, RA - FLy + RB - FW]]);
                </script>
              </div>
              <div>
                <svg-plot
                  class = "variable"
                  name = "Mplot"
                  title = "Moment Plot"
                  x-label = "$x \tx{ (mm)}$"
                  y-label = "$m \tx{ (kN}\cdot \tx{mm)}$"
                  plot-size = "300, 90"
                  grid-on>
                </svg-plot>
                <script type = "solver">
                let t1 = Pbs/2;
                let t2 = Pbs;
                let t3 = Pbs + (Pbw + Gbw)/2 + Clr;

                let ymin = null;
                let ymax = null;

                let line = [];
                let FLy = FL * Math.cos(15 * Math.PI / 180);
                for (let x = 0; x <= t3; x+=0.5) {
                  let y = 0;
                  if (x <= t1) {
                    y = RA * x;
                  } else if (x <= t2) {
                    y = RA * x - FLy * (x - t1);
                  } else if (x <= t3) {
                    y = RA * x - FLy * (x - t1) + (x - t2) * RB;
                  }
                  if (ymin == null || ymin > y) ymin = y;
                  if (ymax == null || ymax < y) ymax = y;
                  line.push([x, y]);
                }

                Mplot.axisStart = `-20,  ${ymin - 500}`;
                Mplot.axisEnd = `${t3 + 20}, ${ymax + 500}`;
                Mplot.line("moment", line);

                return {M_x: line}
                </script>
              </div>
            </div>
            <figcaption>
              Shear Force and Moment diagrams along the shaft.
            </figcaption>
          </figure>

          <output>
            The maximum vertical shear force
            $$V = {R_A}_y - F_L\cos \phi = ~2[V]{RA - FL * cos(phi)} \tx{ kN}$$
            The moment experienced at the chain about the $z$ axis
            $$m_q = \cfrac{\tx{Pbs}}{2}{R_A}_y = ~2[mq]{Pbs * (RA) / 2} \tx{ kN} \cdot \tx{mm}$$
            The maximum moment about the $z$ axis was at point $B$
            $$M_q = \cfrac{\tx{Pbs}}{2}(2{R_A}_y - F_L\cos \phi) = ~1[Mq]{(2 * RA - FL * cos(phi)) * Pbs/2} \tx{ kN} \cdot \tx{mm}$$
          </output>

          <figure style = "margin-left: 5em; margin-right: 5em;">
            <img src = "./fig_FBD_zx.svg" />
            <figcaption>
              FBD of Shaft (from above)
            </figcaption>
          </figure>
          <output>

            Looking at Figure 4 and taking the sum of moments about $A$ the horizontal component of $R_B$ was found
            $$ {R_B}_z = \frac{1}{2}F_L\sin \phi = ~[RBz]{(1/2) * FL * sin(phi)} \tx{ kN}$$
            By taking the sum of forces in the $z$ axis we can find the horizontal component of $R_A$
            $${R_A}_z = {R_B}_z = ~[RAz]{RBz} \tx{ kN}$$
            In this way the maximum moment about the $y$ axis will be between points $A$ and $B$
            $$m_y = \frac{\tx{Pbs}}{2}F_L \sin \phi = ~[my]{(Pbs/2) * RAz} \tx{ kN} \cdot \tx{mm}$$

            Finaly the total magnitude of reaction the forces was found to be
              $$R_A = ~[SRA]{sqrt(RA*RA + RAz*RAz)}\tx{ MPa}, \quad R_B = ~[SRA]{sqrt(RB*RB + RBz*RBz)}\tx{ MPa}$$

            No axial thrust was applied and hence $P_q = ~1[Pq]{0}$
          </output>
        </section>

        <!-- Stress raising factors -->
        <section collapsed>
          <h1>Stress Raising Factors</h1>
          <div>
            Stress raising factors were obtained from the plots in the AS1403 standards.
          </div>
          <figure>
            <plot-image class = "variable" name = "Kkey_FU" src = "../Solver/PlotImageData/keyway.json">
            </plot-image>
            <figcaption>
              Stress raising factor of keyway (auto interpolator).
            </figcaption>
          </figure>
          <output>
            Stress raising factor for the transition fitted key was found to be $K_\tx{key} = ~{Kkey}$.
          </output>
          <figure>
            <plot-image class = "variable" name = "Kfit_FU" src = "../Solver/PlotImageData/fitted.json">
            </plot-image>
            <figcaption>
              Stress raising factor of bearing fit (auto interpolator).
            </figcaption>
          </figure>
          <script type = "solver">
          let kkeys = Kkey_FU(FU);
          let kfits = Kfit_FU(FU);
          return {
            Kkey: kkeys[0],
            Kfit: kfits[0]
          };
          </script>
          <output>
            Stress raising factor for a K8/g6 fitted bearing was found to be $K_\tx{fit} = ~{Kfit}$.
            A final stress
            raising factor was choosen as the maximum stress raising factor and $K = ~[K]{Kkey}$.
          </output>
        </section>

        <!-- AS1403 Axil Diameter Selection (5) -->
        <section collapsed>
          <h1>AS1403 Shaft Diameter Selection</h1>
          <div>
            To calculate the stress raising factor $K_s$ a point was taken on the plot.
          </div>
          <figure>
            <plot-image class = "variable" name = "Ks_D" src = "../Solver/PlotImageData/Ks(D).json">
            </plot-image>
            <figcaption>
              Size stress raising factor (auto interpolator).
            </figcaption>
          </figure>

          <script type = "solver">
          let Ks = 1;
          if (!K) var K = 1;
          log("K = " + K);
          function next_D(d0) {
            // let {Mq, Pq, Tq, FS, FR, K, Ks_D} = scope;
            Ks = Ks_D(d0);
            let KsK = Ks * K;
            // console.log(Ks);
            let d = ((1e4 * FS) / (FR)) *
            sqrt(
              pow(KsK * (Mq + Pq * d0 / 8000), 2) +
              (3/16) * pow((1 + KsK) * Tq, 2)
            );
            return pow(d, 1/3);
          }

          let dia = null;
          let dia0 = D0;
          let error = 1;
          let ittc = 0;
          while (error > 0.001 && ittc < 10) {
            dia = next_D(dia0);
            error = (dia - dia0) / dia;
            dia0 = dia;
            ittc++;
          }

          return {
            D1: dia,
          }
          </script>
          <output>
            The following equation, from the AS1403-2004 rotating shaft standards $$\hat{D}^3 = \cfrac{10^4F_S}{F_R}\sqrt{\left[K_s K \left( M_q + \cfrac{P_q D}{8000}\right)\right]^2 + \cfrac{3}{16}\left[(1 + K_s K )T_q\right]^2}$$ for a shaft with more than 600 start stops and more than 900 power applied torque reversals per year
            was used to find a better diamter $\hat{D}$ from a guess diameter $D$.
            Itterations where continued until $\left| \cfrac{\hat{D} - D}{\hat{D}} \right| \le 0.1\%$.
            Given the trial diameter of $D_0 = ~{D0}\text{mm}$ a final diameter of
            $$D_1 = ~{D1}\text{mm}$$
          </output>
        </section>

        <!-- ASME Ellipse Diameter Selection (5) -->
        <section collapsed>
          <h1>ASME Shaft Diameter Selection</h1>
          <section>
            <h1>Maximum Stresses</h1>
            <output>
              The stress at the center of the shaft $\nu$ was found to be
              $$\nu = \cfrac{VQ}{ID} = \cfrac{16 V}{3 \pi D^2} = ~[tau]{1000 * abs(16 * V / (3 * pi * pow(D2, 2)))} \tx{ MPa}$$
              where $Q = A^\prime \hat{y}^\prime = \cfrac{\pi D^2}{8}\cdot \cfrac{2D}{3 \pi} = \cfrac{D^3}{12}$ and $I = \cfrac{\pi D2^4}{64}$
              The maximum normal stress $\sigma_x$ experienced at the location of the maximum moment was calculated as
              $$\sigma_x = \cfrac{M_q D/2}{I} = \cfrac{32M_q}{\pi D^3} = ~[sigma]{1000*abs(32 * Mq / (pi * pow(D2, 3)))} \tx{ MPa}$$
              The maximum shear stress due to torsion $\tau_{xy}$ was calculated as
              $$\tau_{xy} = \cfrac{T_q D}{2J} = \cfrac{16 T_q}{\pi D^3} = ~[phi]{1000 * 16 * Tq / (pi * pow(D2, 3))} \tx{ MPa}$$
              The values shown above are for calculated for final derived diamter $D_2$.
            </output>
          </section>

          <section>
            <h1>Fatigue Strength Reducing Factors</h1>
            <output>
              To account for stress raising factors the fatigue strength was reduced using the following formula
              $$F_R^\prime = C_{load} \cdot C_{size} \cdot C_{surface} \cdot C_{temp} \cdot C_{reliability} \cfrac{1}{K}F_R$$
              <ul>
                <li>$C_{load} = ~[Cload]{1}$ for an alternating load,</li>
                <li>$C_{size} = ~3[Csize]{1.189 * pow(D1, -0.097)} = 1.189D^{-0.097}$ for a shaft diameter between $8$ and $250\tx{mm}$,</li>
                <li>$C_{surface} = ~3[Csurface]{4.51 * pow(FU, -0.265)} = 4.51 F_U^{-0.265}$ for machined and cold worked surface,</li>
                <li>$C_{temp} = ~[Ctemp]{1}$ for temperatures below $120^\circ$,</li>
                <li>$C_{reliability} = ~3[Crel]{0.814}$ was choosen for confidence of $99\%$.</li>
              </ul>
              In this way reduced fatigue strength was calculated as $F_R^\prime = ~2[FRp]{Cload * Csize * Csurface * Ctemp * Crel * (1/K) * FR} \tx{ MPa}$ for $D_2$.
            </output>
          </section>

          <section>
            <h1>Resolving Alternating and Mean Stresses</h1>
            <output>
              To find the alternating $\sigma_a$ and mean $\sigma_m$ stresses two cases were considered.
              Case 1, the shaft is not moving and holding the load on the tension leg.
              In this way the shaft will experience no alternating stress with the normal and torsional stress contributing only to the mean stress.
              $$\sigma_{a1} = ~[tsa1]{0}$$
              $$\sigma_{m1} = 1000\cdot\cfrac{16}{\pi D^3}\sqrt{4M_q^2 + 3T_q^2} = ~[tsm1]{1000 * 16 * sqrt(4 * Mq * Mq + 3 * Tq * Tq) / (pi * pow(D2, 3))} \tx{ MPa}$$

              Case 2, the shaft is rotating with the load.
              In this case the normal stress will alternate between compression and tension as the shaft spins. The torsional stress will remain constant and
              hence will contribute to the mean stress.
              $$\sigma_{a2} = 1000\cdot \cfrac{32 M_q}{\pi D^3} = ~[tsa2]{abs(1000 * 32 * Mq / (pi * pow(D2, 3)))} \tx{ MPa}$$
              $$\sigma_{m2} = 1000\cdot \sqrt{3}\cfrac{16T_q}{\pi D^3} = ~[tsm2]{abs(1000 * sqrt(3) * 16 * Tq / (pi * pow(D2, 3)))} \tx{ MPa}$$
              Values shown for the final derived diamter $D_2$.
            </output>
          </section>

          <section>
            <h1>Solving for Diameter</h1>
            <div>
              The ASME Fatigue ellipse can be represented in the paramteric form
              $$\sigma_m = \cfrac{F_Y}{F_S}\cos \theta, \quad \sigma_a = \cfrac{F_R^\prime}{F_S} \sin \theta$$
              and can be seen in Figure 8 for $0 \le \theta \le \pi$.
            </div>
            <figure>
              <svg-plot
                class = "variable"
                name = "GL_plot"
                title = "ASME Fatigue Plot"
                y-label = "$\sigma_a \tx{ (MPa)}$"
                x-label = "$\sigma_m \tx{ (MPa)}$"
                grid-on>
              </svg-plot>
              <script type = "solver">
                let sm1 = (1000 * 16 / (pi * pow(D2, 3))) * sqrt(4 * Mq * Mq + 3 * Tq * Tq);
                let sa1 = 0;

                let sa2 = 1000 * 32 * abs(Mq) / (pi * pow(D2, 3));
                let sm2 = 1000 * abs(Tq) * sqrt(3) * 16 / (pi * pow(D2, 3))

                log(sa2 + " x " + sm2)
                let line = [];
                let a = (FY / FS);
                let b = FRp / FS;
                for (let theta = 0; theta < pi/2; theta+=0.01) {
                  let x = cos(theta) * a;
                  let y = sin(theta) * b;
                  line.push([x, y]);
                }

                let ex = (FY / FS) + 20;
                let ey = (FRp / FS) + 20;
                let sx = 300;
                let sy = ey * sx / ex;

                let th1 = atan(a * sa1/(sm1 * b));
                let th2 = atan(a * sa2/(sm2 * b));
                let dx1 = cos(th1) * a - sm1;
                let dy1 = sin(th1) * b - sa1;
                let dx2 = cos(th2) * a - sm2;
                let dy2 = sin(th2) * b - sa2;
                let del1 = sqrt(pow(dx1, 2) + pow(dy1, 2));
                let del2 = sqrt(pow(dx2, 2) + pow(dy2, 2));

                GL_plot.axisStart = "0, 0"
                GL_plot.axisEnd = `${ex}, ${ey}`
                GL_plot.size = `${sx}, ${sy}`
                GL_plot.line("ASME Ellipse", line);
                GL_plot.scatter("shaft-stress-1", [[sm1, sa1]], 2, "blue");
                GL_plot.scatter("shaft-stress-2", [[sm2, sa2]], 2, "blue");


                return {
                  delta1: del1,
                  delta2: del2
                }
              </script>
              <figcaption>
                ASME Ellipse Plot
              </figcaption>
            </figure>
            <output>
              It was seen that the case 2 stress point was always the first
              to exceed the range of the ASME ellipse. Consider the second shaft stress point $(\sigma_{m2}, \ \sigma_{a2})$,
              if it were to lie on the ellipse then $\sigma_{a2} = \sigma_{a}$ from which
              $$\cfrac{1000\cdot 32 F_S M_q }{\pi F_R^\prime \sin \theta} = D^3$$

              The gradient of the line formed between the origin and the point  point $(\sigma_{m2}, \ \sigma_{a2})$ we can see
              $$m_2 = \cfrac{2M_q}{\sqrt{3}T_q}$$
              is independant of $D$ and hence a value of $\theta$ can be solved using the following relation
              $$\theta = \tan^{-1}\left(\cfrac{F_Y 2 M_q}{F_R^\prime \sqrt{3} T_q}\right)$$
              Finaly a value for $D$ can be derived using the following formula
              $$D = 10\sqrt[3]{\cfrac{32 F_S M_q}{\pi F_R^\prime \sin \left[ \tan^{-1}\left(\cfrac{F_Y 2 M_q}{F_R^\prime \sqrt{3} T_q}\right)\right]}}$$
              As the size factor $C_{size}$ used to calculate $F_R^\prime$ is dependant on the diamter, an initial value for $D$ is selected as the trial diameter $D_0$ and a value for $F_R^\prime$ is calculated.
              A new diameter $\hat{D}$ is then computed as per the above equation. $F_R^\prime$ is then recomputed using $\hat{D}$ and process is repeated unitl $\left|\cfrac{\hat{D} - D}{\hat{D}}\right| \le 0.1\%$.
            </output>
            <script type = "solver">
            let frps = Cload * Csurface * Ctemp * Crel * (1 / K) * FR;
            function nextD(d0) {
              let csize = 1.189 * pow(d0, -0.097);
              let frp = frps * csize;

              let theta = atan((FY * 2 * Mq) / (frp * sqrt(3) * Tq));
              let d1 = pow(1000 * 32 * FS * Mq / (pi * frp * sin(theta)), 1/3);

              return d1;
            }

            let d0 = D0;
            let d = d0;
            let error = 100;
            while (abs(error) > 0.001) {
              d = nextD(d0);
              error = (d - d0)/d;
              d0 = d;
            }
            return {
              D2: d,
            }
            </script>
            <output>
              In this way resulting value for the diameter $$D_2 = ~{D2}\tx{ mm}$$
            </output>
          </section>
        </section>
      </section>

      <!-- Gearbox selection (3) -->
      <section collapsed>
        <h1>Gearbox Selection</h1>
        <div>
          As per the specifications on page 7 in the SALA BR-Series-J Hasft Mounted Gearbox datasheet.<br />
          A service factor $\tx{fb} = $<input value="1.2" class = "variable" name = "fb" /> was choosen for a uniform load with no shock, $16$ hours of daily operation and
          $\tx{10 - 200}$ start stops per hour. The maximum allowed torque at the service factor was calculated to be
        </div>
        <output>
          $$T2_\min = T_q \cdot \tx{fb} = ~[T2]{Tq * fb} \tx{ kN} \cdot \tx{mm}$$
          The J72 gearboxes (table on page 47 of datasheet) where the only capable of creating an output speed of $n_e = ~{ne} \pm 5\%$ and $T2 > T2_\min$.
          Details of the two J72 gearboxe variants are shown in the table below.

        </output>
        <script type = "solver">
          let gbh = [
            ["Product ID",  "Reduction Ratio<br />$n_i / n_e$", "Max Torque at 100RPM<br />$\\tx{N} \\cdot \\tx{m}$", "$\\tx{Pt}$<br />$\\tx{kW}$", "Shaft Sleave Diameter<br />$\\tx{mm}$", "$\\tx{Gbw}$<br />$\\tx{mm}$", "Weight<br />$\\tx{kg}$"]
          ]
          let gb = [
            ["J72A",         14.61,            3776,  33,                70,                      203, 90],
            ["J72B",         14.61,            3776,  33,                85,                      203, 90],
            // ["J125",         14.79,            18478,                 125,                     375],
          ]
          return {
            gearboxes: gb,
            gearboxheaders: gbh
          }
        </script>
        <output>
          <table>
            <thead>
              <!-- ~{table2HTMLRows(gearboxheaders)} -->
            </thead>
            <tbody>
              <!-- ~{table2HTMLRows(gearboxes)} -->
            </tbody>
          </table>
        </output>

        <div>
          <ul>
            <li>
              An ambient temperature factor of $\tx{ft} = $ <input class = "variable" value = "0.94" name = "ft" /> was selected (from table 3 of the datasheet).
              to ensure safe operation during hot days of $30^\circ$ temperatures.
            </li>
            <li>
              An altitude factor of $\tx{fa} =$ <input class = "variable" value = "0.95" name = "fa" /> was selected (from table 4 of the datasheet)
              for operation in altidues up to $750\tx{m}$ above sea level.
            </li>
            <li>
              An ambient air velocity factor of $\tx{fv} =$ <input class = "variable" value = "1" name = "fv" /> was selected (from table 5 of the datasheet)
              for operation in a sheltered outdoor space.
            </li>
            <li>
              An operation time factor of $\tx{fu} =$ <input class = "variable" value = "1.15" name = "fu" /> was selected (from table 6 of the datasheet)
              for operation $60\%$ of the time.
            </li>
          </ul>
        </div>
        <output>
          From the equation for power $P = \cfrac{\tx{force} \cdot \tx{linear distance}}{\tx{time}}$ the following expression for power was derived.
          $$P_e = \cfrac{F_L \cdot  2 \pi r_p n_e}{60\tx{s}}\cdot \cfrac{1}{1000} = ~[Pe]{FL * 2 * pi * rp * ne / (60 * 1000)} \tx{ kW}$$
          The minimum thermal rating of the gear was calculated as
          $$\tx{Pt}_\min = \cfrac{P_e}{\tx{ft} \cdot \tx{fa} \cdot \tx{fv} \cdot \tx{fu}}
          = ~[Ptmin]{Pe / (ft * fa * fv * fu)} \tx{ kW}$$
          for a horizontal application. Which was less than the thermal rating of $~{gearboxes[0][3]}\tx{ kW}$ for both J72A and J72B.
        </output>
      </section>

      <!-- Shaft properties (5) -->
      <section collapsed>
        <h1>Final Shaft Selection</h1>
        <div>
          <row-1>
            <div>Selected shaft diameter $D$ = </div>
            <div><input value = "80" class = "variable" name = "D"/> $\tx{mm}$</div>

        </div>
        </row-1>
      </section>

      <!-- Chain Sprocket Key Selection (3) -->
      <section collapsed>
        <h1>Chain Sprocket Key Selection</h1>

        <!-- DATA -->
        <script type = "solver">
          let chain_selcols = [0, 1, 3, 4, 14];
          let chains_head = selectTableColumns([
            //  0           1           2            3                     4                    5                   6               7                 8                         9                     10            11              12                            13                    14                                    15
            ["Product", "Chain No.", "ISO Ref.", "Pitch ($\\tx{inch}$)", "Pitch ($\\tx{mm}$)", "Inside Width B", "Roller Diam. C", "Plate Height D", "Plate Width Inner F", "Plate Width Outer F", "Pin Diam. G", "Pin Length", "Conn. Link Extension J", "Transverse Pitch K", "ISO606 Tensile Strength ($\\tx{kN}$)", "Weight ($\tx{kg / m}$)"]
          ], chain_selcols);
          let chains = selectTableColumns([
            // Page 14
            ["Renold Syno PB", "120A1SP","120-1", 1.50,  38.10,25.50,22.23,36.20,4.80,4.80,11.11,49.3,5.3,"-",125000,5.2],
            ["Renold Syno PB", "140A1SP","140-1", 1.75,  44.45,25.73,25.40,42.23,5.61,5.61,12.71,52.9,5.2,"-",170000,6.8],
            ["Renold Syno PB", "160A1SP","160-1", 2.00,  50.80,31.55,28.58,48.26,6.35,6.35,14.29,63.1,6.5,"-",223000,8.9],
            ["Renold Syno PB", "200A1SP","200-1", 2.50,  63.50,38.00,39.67,60.33,8.13,8.13,19.85,76.9,9.0,"-",347000,14.6],

            // Page 24
            ["Renold Roller Chain", "60A1", "60-1", 0.750, 19.050, 12.57, 11.91, 17.50, 2.45, 2.45, 5.94, 25.3, 2.6, "-", 31300, 1.47],
            ["Renold Roller Chain", "80A1", "80-1", 1.000, 25.400, 15.75, 15.88, 24.13, 3.25, 3.25, 7.94, 32.7, 3.0, "-", 55600, 2.80],
            ["Renold Roller Chain", "100A1", "100-1", 1.250, 31.750, 18.90, 19.05, 30.17, 4.06, 4.06, 9.54, 39.7, 4.2, "-", 87000, 4.20],
            ["Renold Roller Chain", "120A1", "120-1", 1.500, 38.100, 25.23, 22.23, 36.20, 4.80, 4.80, 11.11, 49.3, 5.3, "-", 125000, 5.70],
            ["Renold Roller Chain", "140A1", "140-1", 1.750, 44.450, 25.23, 25.40, 42.23, 5.61, 5.61, 12.71, 52.9, 5.2, "-", 170000, 7.80],
            ["Renold Roller Chain", "160A1", "160-1", 2.000, 50.800, 31.55, 28.58, 48.26, 6.35, 6.35, 14.29, 63.1, 6.5, "-", 223000, 10.40],
            ["Renold Roller Chain", "180A1", "180-1", 2.250, 57.150, 35.48, 35.71, 54.30, 7.11, 7.11, 17.46, 70.6, 7.9, "-", 281000, 13.94],
            ["Renold Roller Chain", "200A1", "200-1", 2.500, 63.500, 37.85, 39.67, 60.33, 8.13, 8.13, 19.85, 76.9, 9.0, "-", 347000, 17.30],
          ], chain_selcols);
          chains.sort((a, b) => a[3] > b[3] ? 1 : -1);
          for (let chain of chains) {
            chain[4] = chain[4]/1000;
          }

          // Pages 72-74
          let socket_selcols = [0, 1, 2, 4, 5, 6, 8];
          let sockets_head = selectTableColumns([
            //        0                   1               2         3           4           5                  6              7             8           9         10                  11            12            13            14            15                16          17            18
            ["Pitch ($\\tx{inch}$)", "No. of Teeth", "PCD A", "Top Diam. C", "Part No.", "Min Bore $\\tx{D}$", "Max Bore $\\tx{D}$", "Boss Diam. E", "Dist Thro. F", "Part No.", "Min Bore (D)", "Max Bore (D)", "Boss Diam.", "Dist Thro.", "Part No.", "Min Bore (D)", "Max Bore (D)", "Boss Diam.", "Dist Thro."]
          ], socket_selcols);
          let sockets = selectTableColumns([
            [1, 30, 243.00, 254.6, "16B1/30T", 20.0, 75.0, 120.0, 50.0, "16B2/30T*", 25.0, 85.0, 130.0, 70.0, "16B3/30T*", 30.0, 85.0, 130.0, 100.0],
            [1, 38, 307.59, 319.2, "16B1/38T*", 25.0, 75.0, 120.0, 50.0, "16B2/38T*", 25.0, 90.0, 140.0, 70.0, "16B3/38T*", 30.0, 90.0, 140.0, 100.0],
            [1.25, 21, 213.03, 232.41, "20B1/21T", 30.0, 100.0, 140.0, 55.0, "20B2/21T", 30.0, 100.0, 140.0, 80.0, "20B3/21T", 30.0, 100.0, 140.0, 115.0],
            [1.25, 25, 253.31, 272.03, "20B1/25T", 30.0, 100.0, 140.0, 55.0, "20B2/25T", 30.0, 100.0, 140.0, 80.0, "20B3/25T", 30.0, 100.0, 140.0, 115.0],
            [1.5, 23, 279.81, 300.23, "24B1/23T", 30.0, 105.0, 150.0, 60.0, "24B2/23T", 30.0, 114.0, 160.0, 100.0, "24B3/23T", 40.0, 114.0, 160.0, 150.0],
            [1.5, 25, 303.99, 324.10, "24B1/25T", 30.0, 105.0, 150.0, 60.0, "24B2/25T", 30.0, 114.0, 160.0, 100.0, "24B3/25T", 40.0, 114.0, 160.0, 150.0],
            [1.75, 23, 326.44, 352.04, "28B1/23T", 30.0, 114.0, 160.0, 75.0, "28B2/23T", 30.0, 128.0, 180.0, 120.0, "28B3/23T", 40.0, 128.0, 180.0, 180.0],
            [1.75, 25, 354.66, 379.98, "28B1/25T", 30.0, 114.0, 160.0, 75.0, "28B2/25T", 30.0, 128.0, 180.0, 120.0, "28B3/25T", 40.0, 128.0, 180.0, 180.0],
            [2, 19, 308.64, 337.82, "32B1/19T", 30.0, 114.0, 160.0, 90.0, "32B2/19T", 40.0, 142.0, 200.0, 120.0, "32B3/19T", 40.0, 142.0, 200.0, 180.0],
            [2, 21, 340.84, 372.66, "32B1/21T", 40.0, 128.0, 180.0, 90.0, "32B2/21T", 40.0, 142.0, 200.0, 120.0, "32B3/21T", 40.0, 142.0, 200.0, 180.0],
          ], socket_selcols);


          return {
            sprocketData: sockets,
            sprocketHeaders: sockets_head,
            chainData: chains,
            chainHeaders: chains_head,
            keywayHeaders: [
              ["b<br />$\\tx{mm}$", "h", "$D_\\min$", "$D_\\max$"]
            ],
            keyways: [
              [8, 7, 22, 30],
              [10, 8, 30, 38],
              [12, 8, 38, 44],
              [14, 9, 44, 50],
              [16, 10, 50, 58],
              [18, 11, 58, 65],
              [20, 12, 65, 75],
              [22, 14, 75, 85],
              [25, 14, 85, 95],
              [28, 16, 95, 110],
              [32, 18, 110, 130],
            ]
          }
        </script>

        <!-- Key Selection -->
        <section>
          <h1>Key Selection</h1>
          <row-2>
            <div>
              <row-1>
                <div>Yield strength of key $S_y$ = </div>
                <div><input value = "200" class = "variable" name = "Sy"/> $\tx{MPa}$</div>
              </row-1>
              <output>
                The key will experience a shearing force due to the torque caused
                by the tension leg
                $$F_K = \cfrac{2T_q}{D} = ~[FK]{2 * Tq / D} \tx{ kN}$$
                By distortion energy theory the shear strength of the key will be
                $$S_{xy} = 0.577S_y = ~[Sxy]{0.577 * Sy} \tx{ MPa}$$

                The minimum safe length for a key was found by equating the keys safe strength
                to the corresponding stress, specifically
                $$l_\min = 1000 \cdot F_S F_K \max (\cfrac{1}{b S_{xy}}, \quad \cfrac{2}{h S_{y}})$$
              </output>
            </div>
            <figure style = "width: 55%">
              <img src = "./key.svg" />
              <figcaption>
                Areas of crush ($l\times \frac{h}{2}$ red) and shear ($b \times l$ blue) stress.
              </figcaption>
            </figure>
          </row-2>
          <script type = "solver">
            let minL = (b, h) => round(1000 * FS * FK * max(1 / (b * Sxy),  2 / (h * Sy)));

            let mml = null;
            let format = [];
            keywayHeaders[0][4] = ("$l_\\min$");
            for (let i = 0; i < keyways.length; i++) {
              let [b, h, minD, maxD] = keyways[i];
              let minl = minL(b,h);
              keyways[i][4] = minl;
              if (D >= minD && D <= maxD) {
                if (mml > minl || mml == null) mml = minl;
                format.push((new Array(5)).fill("selected"));
              }
              else format.push(new Array(5));
            }

            return {
              keywayFormat: format,
              minKeyL: mml,
            }
          </script>

          <output>
            <br />
            A selection of keyway's and their dimensions where selected from the supplied catalogue.
            The keyway's that will fit the selected diameter $D = ~{D}$ are highlghted green in the table below.
            <table caption = "Keyway dimensions in mm.">
              <thead>
                <!-- ~{table2HTMLRows(keywayHeaders)} -->
              </thead>
              <tbody>
                <!-- ~{table2HTMLRows(keyways, keywayFormat)} -->
              </tbody>
            </table>
            It could be seen that the $22 \times 14$ keyway was the best option for $D = 80$.
          </output>


        </section>

        <!-- Sprocket Selection -->
        <section>
          <h1>Sprocket Selection</h1>
          <script type = "solver">
            // log(minKeyL)
            let format = [];
            let vpitches = {}
            for (let i = 0; i < sprocketData.length; i++) {
              let [ptc, teeth, pcd, id, minD, maxD, maxl] = sprocketData[i];
              if ((D >= minD && D <= maxD) && minKeyL < maxl) {
                format.push((new Array(7)).fill("selected"));
                vpitches[ptc] = true;
              }
              else format.push(new Array(7));
            }


            return {
              sprocketFormat: format,
              validPitches: vpitches,
            }
          </script>
          <output>
            A selection of sprockets where selected from the Renold Transmission Chain Catalogue. Viable sprockets,
            with a boss width (Dist Thro. F) greater than that of the required keyway length, are highlighted
            green in the table below.
            <table>
              <thead>
                <!-- ~{table2HTMLRows(sprocketHeaders)} -->
              </thead>
              <tbody>
                <!-- ~{table2HTMLRows(sprocketData, sprocketFormat)} -->
              </tbody>
            </table>
            The minimum keyway length must be less than the selected sprocket's boss width to ensure
            the keyway does not fail. The 32B1/19T Sprocket was choosen as it had the smallest pitch circle diamter
            with boss width greater than the minimum keyway length.
          </output>
        </section>

        <!-- Chain Selection -->
        <section>
          <h1>Chain Selection</h1>
          <div>
            From the Renold Transmission Chain Catalogue two products where selected,
            the Simplex Renold Roller Chain (ANSI Standard) and the Simplex Renold Syno Polymer Bush (ANSI Standard) across a range of diffferent pitches.
            The Polymer Bush was recomended for mixers in the catalogue. Chains with pitches equal to viable sprocket pitches can be seen highlighted in green below.
          </div>
          <script type = "solver">
            let format = [];
            for (let i = 0; i < chainData.length; i++) {
              let [id, cid, ptc, ptcmm, maxT] = chainData[i];
              if (ptc in validPitches && maxT > (FL * FS)) {
                format.push((new Array(5)).fill("selected"));
              }
              else format.push(new Array(5));
            }


            return {
              chainFormat: format,
            }
          </script>
          <output>
            <table>
              <thead>
                <!-- ~{table2HTMLRows(chainHeaders)} -->
              </thead>
              <tbody>
                <!-- ~{table2HTMLRows(chainData, chainFormat)} -->
              </tbody>
            </table>
            From the Table 2 it can be seen that both $2^"$ chains where capable of taking
            loads far beyond the required $F_L = ~{FL} \tx{ kN}$.
          </output>
        </section>

      </section>

      <!-- Plumber Block and Bearing Selection -->
      <section collapsed>
        <script type = "solver">
          // let bearings = ;
          log("hey")
          return {
            bearings: [
              ["SYNT35",35,96.5,35,"-"],
              ["SYNT40",40,96.5,9.8,"ECY208"],
              ["SYNT45",45,102,10.8,"ECY209"],
              ["SYNT50",50,104,11.8,"ECY210"],
              ["SYNT55",55,125,13.7,"ECY211"],
              ["SYNT60",60,156,18.6,"ECY212"],
              ["SYNT65",65,193,24,"ECY213"],
              ["SYNT70",70,208,25.5,"ECY214"],
              ["SYNT75",75,212,26.5,"ECY215"],
              ["SYNT80",80,236,29,"–"],
              ["SYNT90",90,325,39,"–"],
              ["SYNT100",100,425,49,"–"]
            ],
          }
        </script>
        <h1>Plumber Block and Bearing Selection</h1>
        <output>
          <table>
            <thead>
              <tr>
                <td>Bearing unit</td><td>Shaft diameter $\tx{mm}$</td><td>Basic load ratings $\tx{kN}$</td><td>Fatigue load limit $\tx{kN}$</td><td>End cover</td>
              </tr>
            </thead>
            <tbody>
              <!-- ~{table2HTMLRows(bearings)} -->
            </tbody>
          </table>
        </output>
      </section>

      <!-- Drawings -->
      <section collapsed>
        <h1>Mechanical Drawings</h1>

        <div>
          Click on the drawings to save them as A3 PDF's. The shaft drawing is provided
          as per specifications set in this document.
        </div>
        <script type = "solver">
          // let sr = min(Clr, abs(DG - D)/2),
          let sdd = 17;
          let snn = 40;
          //          l,   EF,  F,  G
          let gbks = [138, 20,  22, 76];
          //         b x h   l
          let spk = [22, 14, 90];

          // distance from key to center of circle
          let cc =  sqrt(DG * DG - gbks[2] * gbks[2])/2;
          let Gkh =  2 * (cc - (gbks[3] - DG/2));

          let cc2 = (sqrt(D * D - spk[0] * spk[0]) - spk[1]) / 2;

          let swidth = min(Clr, abs(DG - D)/2);
          let scale = sdd/snn;

          let v2t = (num) => {return round(num / scale, 2)};
          return {
            sr: scale * swidth,
            sw: (Pbs + Clr + Pbw) * scale,
            clr: Clr * scale,
            cf: 2 * scale,
            dg: DG * scale,
            d: D * scale,
            gw: Gbw * scale,

            gks: scale * gbks[1],
            gkcx: scale * (gbks[1] + gbks[0] / 2),
            gkl: scale * gbks[0],
            gkb: scale * gbks[2],
            gkh: scale * Gkh,
            gkcc: scale * cc,

            sks: scale * (Clr + (Pbw + Pbs - spk[2]) / 2),
            skl: scale * spk[2],
            skh: scale * spk[1],
            skb: scale * spk[0],
            skcc: scale * cc2,
            skro: scale * spk[0],
            skror: scale * spk[0]*2,

            dmw: scale * D / 3,
            dmws: scale * D / 4.5,

            sdom: sdd,
            snum: snn,



            dimension: (x0, y0, dx, dy, flip = false) => {
              let dist = sqrt(dx * dx + dy * dy);
              let text = v2t(dist);
              let intr = dist < 12;
              let hori = dx > dy;
              if (!hori && intr) {
                y0 += dy;
                x0 += dx;
                dx *= -1;
                dy *= -1;
              }

              const ext = 9;
              const fc = 1.5;
              const fh = 2.8;
              const fsp = 1;

              let ix = ext * dx / dist;
              let iy = ext * dy / dist;

              let type = intr ? "x" : "i";
              let tx = intr ? (x0 + dx + ix) : (x0 + dx/2);
              let ty = intr ? (y0 + dy + iy) : (y0 + dy/2);
              let anc = "middle";
              if (hori) {
                ty += intr ? fc : (flip ? (fh + fsp) : -fsp);
                anc = intr ? "start" : "middle";
              } else {
                ty += intr ?  0 : fc;
                tx += intr ?  0 : (flip ? fsp : -fsp);
                anc = intr ? "middle" : (flip ? "start" : "end");
              }
              return `
              <path d = "M${x0},${y0}l${dx},${dy}" marker-end="url(#arrow-e-${type})" marker-start="url(#arrow-s-${type})"></path>
              <text font-size = "4" x = "${tx}" y = "${ty}" text-anchor = "${anc}">${text}</text>
              `
            },
            vec2tex: v2t
          }
        </script>
        <output>
          <figure>
            <print-img size = "A3 landscape">
              <svg viewBox="0 0 1190.6 841.9">
                <style>
                  .drawing {
                    stroke-linecap: round;
                    --dim-c: gray;
                    font-family: serif;
                  }
                  .lines{
                    stroke-width: 0.5;
                    stroke: black;
                    fill: none;
                  }
                  .ctr {stroke-dasharray: 9 2 2 2; stroke-width: 0.25;}
                  .dash {stroke-dasharray: 1.5 0.75; stroke-width: 0.25;}
                  .dim path {
                    fill: none;
                    stroke: var(--dim-c);
                    stroke-width: 0.25;
                  }
                  .dim text {
                    stroke: none;
                    fill: var(--dim-c);
                  }
                </style>
                <defs>
                  <marker id="arrow-e-i" markerWidth="15" markerHeight="5" refX="15" refY="2.5" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L15,2.5L0,5 z" fill="gray" />
                  </marker>
                  <marker id="arrow-s-i" markerWidth="15" markerHeight="5" refX="0" refY="2.5" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,2.5 L15,5L15,0 z" fill="gray" />
                  </marker>

                  <marker id="arrow-e-x" markerWidth="30" markerHeight="5" refX="0" refY="2.5" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L15,2.5L0,5z" fill="gray" />
                    <path d="M0,2.5h30" fill = "none" stroke = "gray"></path>
                  </marker>
                  <marker id="arrow-s-x" markerWidth="20" markerHeight="5" refX="20" refY="2.5" orient="auto" markerUnits="strokeWidth">
                    <path d="M5,2.5 L20,5L20,0z" fill="gray" />
                    <path d="M0,2.5h20" fill = "none" stroke = "gray"></path>
                  </marker>

                </defs>

                <g>
                  <text transform="matrix(1.0001 0 0 1 677.7386 724.2448)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6142px;">Gabriel Ralph</text>
                  <text transform="matrix(1.0001 0 0 1 677.7386 736.2692)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6142px;">Gabriel Ralph</text>
                  <text transform="matrix(1 0 0 1 786.2855 723.9186)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6142px;">27 Oct 22</text>
                  <text transform="matrix(1.0001 0 0 1 979.6478 743.1599)" style="fill:#010101; font-family:'CenturyGothic'; font-size:22px;">Shaft</text>
                  <text transform="matrix(1 0 0 1.0001 681.1136 690.9274)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6133px;">± 0.1mm</text>
                  <text transform="matrix(1 0 0 1.0001 699.0132 677.1491)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6133px;">Machined and Polished</text>
                  <text transform="matrix(1.0002 0 0 1 689.0316 698.3288)" style="fill:#010101; font-family:'CenturyGothic'; font-size:6.6142px;">± 0.1°</text>
                  <text transform="matrix(1 0 0 1 821.7592 788.9899)" style="fill:#010101; font-family:'CenturyGothic'; font-size:11.9996px;">Cold Rolled Steel</text>
                  <text transform="matrix(1 0 0 1.0006 5.6419 788.4157)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.027px;">A</text>
                  <text transform="matrix(1 0 0 1.0006 1167.849 788.4157)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.027px;">A</text>
                  <text transform="matrix(1 0 0 1.0001 7.5541 648.8161)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0383px;">B</text>
                  <text transform="matrix(1 0 0 1.0001 1169.7611 648.8161)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0383px;">B</text>
                  <text transform="matrix(1 0 0 1.0006 4.8124 507.0739)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0258px;">C</text>
                  <text transform="matrix(1 0 0 1.0006 1167.0189 507.0739)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0258px;">C</text>
                  <text transform="matrix(1 0 0 1.0003 5.596 365.3317)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0322px;">D</text>
                  <text transform="matrix(1 0 0 1.0003 1167.8031 365.3317)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0322px;">D</text>
                  <text transform="matrix(1.0009 0 0 1 7.992 223.59)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">E</text>
                  <text transform="matrix(1.0009 0 0 1 1170.1986 223.59)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">E</text>
                  <text transform="matrix(1 0 0 1.0013 8.5912 83.9904)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0103px;">F</text>
                  <text transform="matrix(1 0 0 1.0013 1170.7982 83.9904)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.0103px;">F</text>
                  <text transform="matrix(1.0003 0 0 1 78.6556 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">8</text>
                  <text transform="matrix(1.0003 0 0 1 78.6556 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">8</text>
                  <text transform="matrix(1.0003 0 0 1 234.5672 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">7</text>
                  <text transform="matrix(1.0003 0 0 1 234.5672 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">7</text>
                  <text transform="matrix(1.0003 0 0 1 376.3094 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">6</text>
                  <text transform="matrix(1.0003 0 0 1 376.3094 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">6</text>
                  <text transform="matrix(1.0003 0 0 1 518.0516 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">5</text>
                  <text transform="matrix(1.0003 0 0 1 518.0516 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">5</text>
                  <text transform="matrix(1.0003 0 0 1 659.7933 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">4</text>
                  <text transform="matrix(1.0003 0 0 1 659.7933 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">4</text>
                  <text transform="matrix(1.0003 0 0 1 801.5355 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">3</text>
                  <text transform="matrix(1.0003 0 0 1 801.5355 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">3</text>
                  <text transform="matrix(1.0003 0 0 1 943.2777 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">2</text>
                  <text transform="matrix(1.0003 0 0 1 943.2777 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">2</text>
                  <text transform="matrix(1.0003 0 0 1 1099.1898 834.0807)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">1</text>
                  <text transform="matrix(1.0003 0 0 1 1099.1898 20.5383)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.04px;">1</text>
                  <text transform="matrix(1 0 0 1.1693 653.7806 723.9186)" style="fill:#010101; font-family:'CenturyGothic'; font-size:4.8484px;">DRAWN</text>
                  <text transform="matrix(1 0 0 1.0281 654.6195 735.8893)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5144px;">CHK&apos;D</text>
                  <text transform="matrix(1 0 0 1.0242 653.0941 747.4997)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5354px;">APPV&apos;D</text>
                  <text transform="matrix(1 0 0 1.0194 655.141 759.8307)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5614px;">MFG</text>
                  <text transform="matrix(1 0 0 1.0218 656.2357 771.7702)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5482px;">Q.A</text>
                  <text transform="matrix(1 0 0 1.0279 653.639 662.8737)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5152px;">UNLESS OTHERWISE SPECIFIED:</text>
                  <text transform="matrix(1 0 0 1.0266 653.639 669.9606)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5222px;">DIMENSIONS ARE IN MILLIMETERS</text>
                  <text transform="matrix(1 0 0 1.0306 653.639 677.0475)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5012px;">SURFACE FINISH:</text>
                  <text transform="matrix(1 0 0 1.0242 653.639 684.1335)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5354px;">TOLERANCES:</text>
                  <text transform="matrix(1 0 0 1.0267 653.639 691.2204)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5216px;">   LINEAR:</text>
                  <text transform="matrix(1 0 0 1.0211 653.639 698.3073)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.552px;">   ANGULAR:</text>
                  <text transform="matrix(1 0 0 1.0245 882.4408 662.6413)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5336px;">DEBURR AND </text>
                  <text transform="matrix(1 0 0 1.022 882.4408 669.7282)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5471px;">BREAK SHARP </text>
                  <text transform="matrix(1 0 0 1.0228 882.4408 676.8151)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5431px;">EDGES</text>
                  <text transform="matrix(1 0 0 1.0199 692.559 712.2536)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5584px;">NAME</text>
                  <text transform="matrix(1 0 0 1.0252 737.0961 712.0837)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5299px;">SIGNATURE</text>
                  <text transform="matrix(1 0 0 1.0179 785.8011 712.0436)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5696px;">DATE</text>
                  <text transform="matrix(1 0 0 1.0243 809.7035 770.4089)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5347px;">MATERIAL:</text>
                  <text transform="matrix(1 0 0 1.0198 971.1879 666.8141)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5593px;">DO NOT SCALE DRAWING</text>
                  <text transform="matrix(1 0 0 1.0295 1086.5922 667.3757)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5068px;">REVISION</text>
                  <text transform="matrix(1 0 0 1.0336 935.681 712.0436)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.4848px;">TITLE:</text>
                  <text transform="matrix(1 0 0 1.0212 935.2894 770.4089)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.5515px;">DWG NO.</text>
                  <text transform="matrix(1 0 0 1.0337 935.6293 807.5036)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.4843px;">SCALE:</text>
                  <text transform="matrix(1 0 0 1.0337 956.2833 807.5036)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.4843px;">~{sdom}:~{snum}</text>
                  <text transform="matrix(1 0 0 1.0324 1061.4994 807.5036)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.4912px;">SHEET 1 OF 1</text>
                  <text transform="matrix(1 0 0 1.0116 1136.3168 778.8776)" style="fill:#010101; font-family:'CenturyGothic'; font-size:10.8739px;">A3</text>
                  <text transform="matrix(1 0 0 1.025 809.6136 807.3532)" style="fill:#010101; font-family:'CenturyGothic'; font-size:5.526px;">WEIGHT: </text>
                  <text transform="matrix(1 0 0 1.0207 999.6293 790.8893)" style="fill:#010101; font-family:'CenturyGothic'; font-size:23.5144px;">Shaft R3</text>
                  <path style="fill:none;stroke:#C1C0C0;stroke-width:0.992;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" d="
                  M1020.4,811.5v21.3 M1020.4,26.3V5 M878.7,811.5v21.3 M878.7,26.3V5 M737,811.5v21.3 M737,26.3V5 M595.2,811.5v21.3 M595.2,26.3V5
                  M453.5,811.5v21.3 M453.5,26.3V5 M311.8,811.5v21.3 M311.8,26.3V5 M170,811.5v21.3 M170,26.3V5 M1162.2,135.4h21.2 M28.3,135.4H7
                  M1162.2,277.2h21.2 M28.3,277.2H7 M1162.2,418.9h21.2 M28.3,418.9H7 M1162.2,560.6h21.2 M28.3,560.6H7 M1162.2,702.4h21.2
                  M28.3,702.4H7 M595.2,832.8v-21.3 M1183.4,418.9h-21.2 M595.2,5v21.3 M7,418.9h21.3"/>
                  <path style="fill:none;stroke:#C1C0C0;stroke-width:1.417;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" d="
                  M1162.2,787.4h-36.9 M1162.2,673H932 M1125.3,799.5v-36.2 M1079.4,673v-18.1 M1057.3,811.5v-12 M932,654.9v156.6 M806.7,763.3
                  h355.5 M806.7,763.3H651.9 M806.7,775.4H651.9 M880.4,654.9v108.4 M806.7,787.4H651.9 M836.2,751.3v-48.2 M777.8,703.1v108.4
                  M777.8,703.1v-48.2 M674,703.1v108.4 M651.9,654.9v156.6 M932,715.1H651.9 M932,727.2H651.9 M932,739.2H651.9 M932,751.3H651.9
                  M728.4,703.1v108.4 M651.9,654.9h510.3 M1162.2,703.1H651.9 M651.9,799.5h510.3"/>
                  <path style="fill:none;stroke:#C1C0C0;stroke-width:1.984;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" d="
                  M1162.2,811.5H28.3 M1162.2,26.3v785.2 M28.3,26.3h1133.9 M28.3,811.5V26.3"/>
                  <g>
                    <circle style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" cx="811.5" cy="679" r="7"/>
                    <circle style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" cx="811.5" cy="679" r="11.8"/>
                    <polygon style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" points="
                    834.7,672 862.1,667.2 862.1,690.8 834.7,686.1 		"/>
                    <g>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;" x1="796.3" y1="679" x2="800.3" y2="679"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:1.0848,2.1695;" x1="802.5" y1="679" x2="804.7" y2="679"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:8.6782,2.1695,1.0848,2.1695;" x1="805.8" y1="679" x2="861.1" y2="679"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;" x1="862.2" y1="679" x2="866.2" y2="679"/>
                    </g>
                    <g>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;" x1="811.5" y1="697" x2="811.5" y2="693"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:0.9039,1.8077;" x1="811.5" y1="691.2" x2="811.5" y2="689.4"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:7.2309,1.8077,0.9039,1.8077;" x1="811.5" y1="688.5" x2="811.5" y2="665.9"/>
                      <line style="fill:none;stroke:#AFB0B2;stroke-width:0.7087;stroke-linecap:round;stroke-linejoin:round;" x1="811.5" y1="665" x2="811.5" y2="661"/>
                    </g>
                  </g>
                  <path style="fill:none;stroke:#010101;stroke-width:0.5;stroke-miterlimit:10;" d="M746.7,719.7c-0.8-0.1-1.6,0.2-2.1,0.8
                  c-0.5,0.6-0.8,1.3-1,2.1c-0.2,0.5-0.3,1.1-0.1,1.6c0.2,0.5,0.8,0.8,1.3,0.9c1,0.2,2-0.2,2.8-0.9s1.4-1.5,1.8-2.4"/>
                  <path style="fill:none;stroke:#010101;stroke-width:0.5;stroke-miterlimit:10;" d="M747.2,722.6c1.2-1,2.5-1.8,4-2.3
                  c0.8-0.3,1.8-0.5,2.6-0.2c0.8,0.3,1.6,1,1.5,1.9c-0.1,1-1,1.7-1.9,2c-0.6,0.2-1.2,0.3-1.8,0.3c-0.6-0.1-1.2-0.3-1.6-0.8
                  c-0.1-0.2-0.2-0.4-0.1-0.6c0.1-0.1,0.1-0.1,0.2-0.1c0.6-0.1,1.3-0.1,1.8,0.3c0.5,0.3,0.8,0.7,1.3,1c0.6,0.4,1.3,0.5,1.9,0.6
                  c1.5,0.2,3.1,0.2,4.6,0c0.2,0,0.4-0.1,0.6-0.2c0.2-0.2,0.2-0.4,0.2-0.7c0.1-1.4-0.3-2.7-0.6-4c0-0.1-0.1-0.2,0-0.3
                  c0.1-0.1,0.2-0.1,0.3-0.1c1.4,0,2.7,0.4,3.9,1.1"/>
                  <line style="fill:none;stroke:#C1C0C0;stroke-width:1.417;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" x1="806.7" y1="763.3" x2="806.7" y2="799.5"/>
                </g>

                <g class = "drawing" transform = "scale(2.835) translate(47, 100)">
                  <g name = "FRONT">
                    <g class = "dim">
                      <path d = "M0,~{dg}v~{dmw}m~{gw},0v~{-dmw}m~{sw},~{-sr}v~{dmw+sr}"></path>
                      <path d = "M~{gks},~{dg/2}V~{-2*dmw}M~{gks + gkl},~{dg/2}V~{-dmw}"></path>
                      <path d = "M~{gw + sks},~{dg/2 - skcc}V~{-2*dmw}M~{gw + sks + skl},~{dg/2 - skcc}V~{-dmw*2}"></path>
                      <path d = "M~{gw + sks + skl + skro},~{sr}V~{-dmw}"></path>
                      <path d = "M~{gw},0V~{-2*dmw}"></path>
                      <path d = "M~{0},0V~{-2*dmw}"></path>
                      <path d = "M~{0},0h~{-2*dmw}m0,~{dg}h~{2*dmw}"></path>
                      <path d = "M~{gks},~{(dg - gkb)/2}H~{-dmw}m0,~{gkb}H~{gks}"></path>
                      <path d = "M~{gw + sw},~{sr}h~{dmw}m0,~{d}h~{-dmw}"></path>
                      ~{dimension(gw, dg + dmw/2, sw, 0, 1)}
                      ~{dimension(0, dg + dmw/2, gw, 0, 1)}
                      ~{dimension(gks, -dmw/2, gkl, 0)}
                      ~{dimension(gw, -3*dmw/2, sks, 0)}
                      ~{dimension(0, -3*dmw/2, gks, 0)}

                      ~{dimension(gw + sks, -3 * dmw/2, skl, 0)}
                      ~{dimension(gw + sks + skl, -dmw/2, skro, 0)}
                      ~{dimension(-3 * dmw / 2, 0, 0, dg)}
                      ~{dimension(- dmw / 2, (dg - gkb)/2, 0, gkb)}

                      ~{dimension(gw + sw + dmw/2, sr, 0, d, 1)}
                      <path fill = "none" d = "M~{gw + sw + dmw/2 + 3},~{sr - dmw/2}h-3l~{-dmw/2},~{dmw/2}" marker-end = "url(#arrow-e-i)"></path>
                      <text x = "~{gw + sw + dmw/2 + 5}" y = "~{sr - dmw/2}" font-size = "4">~{vec2tex(cf)} x 45˚</text>

                      <path fill = "none" d = "M~{gw + sr + dmw/2 + 3},~{- dmw/2}h-3l~{-dmw/2},~{dmw/2}" marker-end = "url(#arrow-e-i)"></path>
                      <text x = "~{gw + sr + dmw/2 + 5}" y = "~{-dmw/2}" font-size = "4">R~{vec2tex(sr)}</text>

                      <path fill = "none" d = "M~{gw + sw * 0.85},~{sr - dmws/sqrt(3)}h~{-dmws}l~{dmws/2},~{dmws/sqrt(3)}l~{dmws},~{-2 * dmws/sqrt(3)}"></path>
                      <text x = "~{gw + sw * 0.85 - dmws/2}" y = "~{-dmws/sqrt(3)}" text-anchor = "middle" font-size = "4">0.3</text>
                    </g>
                    <g class = "lines">
                      <path class = "ctr" d = "M~{-dmw/4},~{dg/2}h~{sw + gw + dmw/2}"></path>
                      <path d = "M0,~{cf}v~{dg - 2*cf}l~{cf},~{cf},h~{gw-cf}a~{sr},~{sr},0,0,1,~{sr},-~{sr}h~{sw - sr - cf}l~{cf}-~{cf}v-~{d - 2 * cf}l-~{cf}-~{cf}h-~{sw - sr - cf}a~{sr},~{sr},0,0,1,-~{sr},-~{sr}h-~{gw - cf}ZM~{cf},0v~{dg}M~{gw},0v~{dg}M~{gw + sw - cf},~{sr}v~{d}"></path>
                      <rect x = "~{gkcx - (gkl + gkb)/2}" y = "~{(dg - gkb)/2}" width = "~{gkl + gkb}" height = "~{gkb}" rx = "~{gkb/2}" ry = "~{gkb/2}"></rect>
                      <path class = "dash" d = "M~{gw + sks - skro},~{sr}a~{skror},~{skror},0,0,0,~{skro},~{d/2 - skcc}h~{skl}a~{skror},~{skror},0,0,0,~{skro}-~{d/2 - skcc}"></path>
                    </g>
                  </g>

                  <g transform = "translate(~{sw + gw + dg/2 + dmw*2}, 0)" >
                    <g class = "dim">
                      <path d = "M~{-skb/2},~{sr + (d - sqrt(d*d - skb*skb))/2}V~{-dmw}"></path>
                      <path d = "M~{skb/2},~{sr + (d - sqrt(d*d - skb*skb))/2}V~{-dmw}"></path>
                      <path d = "M~{skb/2 + dmw/8},~{sr + (d - sqrt(d*d - skb*skb))/2 + skh/2}H~{dg/2 + dmw}M~{dg/2 + dmw/4},~{dg/2}H~{dg/2 + dmw}"></path>
                      <path d = "M~{-gkcc + gkh/2},~{dmw/8 + (dg + gkb)/2}V~{dg + dmw}"></path>
                      <path d = "M0,~{dg + dmw/4}V~{dg + dmw}"></path>
                      ~{dimension(-skb/2, -dmw/2, skb, 0)}
                      ~{dimension(-gkcc + gkh/2, dg + dmw/2, gkcc - gkh/2, 0, true)}
                      ~{dimension((dg + dmw)/2, dg/2 -skcc, 0, skcc, true)}
                    </g>
                    <g class = "lines">
                      <path class = "ctr" d = "M0,~{-dmw/4}v~{dg + dmw/2}M~{-dmw/4 - dg/2},~{dg/2}h~{dg + dmw/2}"></path>
                      <circle r = "~{dg/2}" cy = ~{dg/2}></circle>
                      <circle r = "~{dg/2 - sr}" cy = ~{dg/2}></circle>
                      <circle r = "~{dg/2 - sr - cf}" cy = ~{dg/2}></circle>

                      <path class = "dash" d = "M~{-gkcc},~{(dg - gkb)/2}h~{gkh/2}v~{gkb}h-~{gkh/2}"></path>
                      <path class = "dash" d = "M~{-skb/2},~{dg/2 - skcc - skh/2}v~{skh/2}h~{skb}v-~{skh/2}"></path>
                    </g>
                  </g>
                </g>


              </svg>
            </print-img>
            <figcaption>
              Shaft design drawings.
            </figcaption>
          </figure>
        </output>
        <figure>
          <print-img size = "A3 landscape">
            <img src = "./frame-iso.svg" />
          </print-img>
          <figcaption>
            Frame design drawings.
          </figcaption>
        </figure>
      </section>

      <!-- Tolerancing Considerations -->
      <section collapsed>
        <h1>Consideration for Tolerancing</h1>
        <section>
          <!-- Angular Deflection -->
          <h1>Angular Deflection</h1>

          <output>
            Although the axil will deflect due to the weight of the motor
            this will occur in the oppisite direction to the deflection caused by
            the chain drive. Taking second moment of inertia as $I = \cfrac{\pi D^4}{64}$ the maxmimum angular deflection at both plumber blocks calculated to be

            $$\theta_{RA2} = ~3{180 * (Pbs * Pbs / 24) * (16 * RA - 5 * FL * sin(phi)) / (E * pow(D, 4) * pi * pi / 64)}$$
            $$\theta_{RA} = M_q\cfrac{\tx{Pbs} 16}{3 \pi D^4 E} = ~3[theta_a]{(180/pi) * Mq * (16 * Pbs) / (3 * E * pi * pow(D0, 4))}^\circ$$
            $$\theta_{RB} = 5M_q\cfrac{\tx{Pbs} 16}{3 \pi D^4 E} = ~3[theta_a]{(180/pi) * -5 * Mq * (16 * Pbs) / (3 * E * pi * pow(D0, 4))}^\circ$$


            <!-- $$\cfrac{dy}{dx} = \cfrac{1}{EI}\left[(R_A - F_L)\cfrac{x^2}{2} + \frac{\tx{Pbs}}{2}x + C\right]$$
            Taking $x = \cfrac{\tx{Pbs}}{2}$ gives
            $$\frac{F_L \tx{Pbs}^2}{16EI} - \cfrac{F_W d_1 \tx{Pbs}}{6EI} = ~5[theta]{(FL * pow(Pbs, 2)/16 - 0*FW * d1 * Pbs / 6) * 64 / (E * pi * pow(D, 4))}$$ -->
          </output>
        </section>
      </section>



    </solver-frame>
  </body>

  <script>
    async function delay(t) {
      return new Promise(function(resolve, reject) {
        setTimeout(resolve, t);
      });
    }

    async function scrollDown(t) {
      await delay(5000);
      let height = document.body.scrollHeight;
      console.log(height);

      let inc_p_ms = height / (15000);

      for (let i = 0; i < height; i+=inc_p_ms * 20) {
        window.scrollTo(0, i);
        await delay(20);
      }
    }

    // scrollDown()

  </script>


  <style>
  :root {
    --fs: calc(0.9vmax + 0.9vmin);
    --h1-fs: 2.7em;
    --caption-spacing: calc(var(--fs) * 1);
    --figure-spacing: calc(var(--fs) * 3);
    counter-reset: tables;
  }

  body {
    display: flex;
    font-family: "Supreme LL TT";
    font-weight: 300;
    flex-direction: column;
    font-size: var(--fs);
    margin: 2.5em auto;
    width: min(270mm, calc(100% - 5em));
    counter-reset: figs;
  }
  section {
    padding-left: calc(var(--fs) * 2);
    display: flex;
    flex-direction: column;
  }
/*
  solver-frame {
  } */



  section > section:first-of-type > h1 {
    margin-top: 0;
  }
  section[collapsed] > :not(h1) {
    /* display: none; */
    visibility: hidden;
    width: 0;
    height: 0;
    margin: 0;
    padding: 0;
    overflow: hidden;
    display: inline-block;
  }
  section[collapsed] > h1:first-of-type::before {
    content: " ▼";
    font-size: var(--fs);
    position: absolute;
    left: calc(-1 * var(--fs));
    top: 50%;
    color: #c2b4b4;
    transform: translate(-100%, -50%);
    /* float: right; */
  }
  section h1 {
    position: relative;
    font-size: var(--h1-fs);
    margin-top: calc(var(--fs) * 3);
    margin-bottom: calc(var(--fs) * 0.5);
    cursor: pointer;
  }
  section section {
    --h1-fs: 1.7em;
  }
  section section section {
    --h1-fs: 1.3em;
  }

  figure{
    display: flex;
    flex-direction: column;
    gap: var(--caption-spacing) 0;
    margin: var(--figure-spacing) 0;
    counter-increment: figs;
  }
  figure figcaption {
    text-align: center;
    font-size: 0.8em;
    font-style: italic;
  }
  figure figcaption::before {
    content: "Figure " counter(figs) ": ";
  }

  .shear {
    stroke: #1effd5;
    filter: url(#glow);
    stroke-linejoin: round;
  }
  .moment {
    stroke: #fffb1d;
    filter: url(#glow);
    stroke-linejoin: round;

  }

  input.variable  {

    /* font: "Times New Roman"; */
    font: inherit;
    font-family: Times;
    display: inline;
    outline: none;
    border: none;
    border-bottom: 1px solid black;
    padding: 0;
    margin: 0;
  }
  li{
    padding-bottom: var(--caption-spacing);
  }
  table {width: 100%;}
  img {
    width: 100%;
  }


  table {
    border-collapse: collapse;
    margin: var(--figure-spacing) 0;
    margin-bottom: calc(var(--figure-spacing) + var(--caption-spacing) + 1em);
    position: relative;
  }
  table::after{
    counter-increment: tables;
    position: absolute;
    bottom: 0;
    left: 50%;
    text-align: center;
    white-space: pre;
    content: "Table " counter(tables) "\a" attr(caption);
    font-style: italic;
    transform: translate(-50%, 100%);
    padding-top: var(--caption-spacing);
  }
  table td {
    border: 1px solid black;
    text-align: center;
    vertical-align: middle;
  }
  thead td {
    background: #2f3232;
    color: #e9ebf1;
  }
  td.selected {
    background: #d0fbd0;
  }
  td {
    padding: 0.3em;
  }



    row-2 {
      display: flex;
      width: 100%;
      gap: 0.5em;
      justify-content: space-between;
    }
    row-2 > * {
      width: 100%;
    }
    row-1 {
      display: flex;
      /* justify-content: center; */
      gap: 0.5em;
      align-items: center;
      min-height: 3em;
    }

    row-2 figure {
      margin: 0;
    }
    row-2 svg-plot {
      font-size: 0.7em;
    }
    svg-plot {
      font-size: 0.9em;

      /* margin: 2.5em 0 0.7em 0; */
    }

    plot-image {
      display: flex;
      justify-content: center;
    }
    plot-image svg {
      width: 100%;
      height: 100%;
    }

    output {
      display: block;
    }
  </style>
</html>
